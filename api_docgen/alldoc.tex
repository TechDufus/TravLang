\documentclass{book}
\usepackage[colorlinks=true,breaklinks=true]{hyperref}
\usepackage{color}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\input{iftravlangdoc}
\iftravlangdoc
\usepackage{travlangdoc}
\usepackage{textcomp}
\else
\usepackage{changepage}
\usepackage{listings}
\newcommand{\travlangkeyword}{\bfseries}
\newcommand{\travlanghighlight}{\bfseries\uline}
\newcommand{\travlangerror}{\bfseries}
\newcommand{\travlangwarning}{\bfseries}
\definecolor{gray}{gray}{0.5}
\newcommand{\travlangcomment}{\color{gray}\normalfont\small}
\newcommand{\travlangstring}{\color{gray}\bfseries}
\lstnewenvironment{travlangcodeblock}{
  \lstset{
    backgroundcolor = \color{lightgray},
    basicstyle=\ttfamily,
    showstringspaces=false,
    language=caml,
    escapeinside={$}{$},
    columns=fullflexible,
    stringstyle=\travlangstring,
    commentstyle=\travlangcomment,
    keepspaces=true,
    keywordstyle=\travlangkeyword,
    moredelim=[is][\travlanghighlight]{<<}{>>},
    moredelim=[s][\travlangstring]{\{|}{|\}},
    moredelim=[s][\travlangstring]{\{delimiter|}{|delimiter\}},
    keywords={[2]{val,initializer,nonrec}}, keywordstyle={[2]\travlangkeyword},
    belowskip=0\baselineskip,
    upquote=true,
    literate={'"'}{\textquotesingle "\textquotesingle}3
    {'\\"'}{\textquotesingle \textbackslash"\textquotesingle}4,
  }
  }{}
\newcommand{\travlangtag}[2]{\begin{travlang#1}#2\end{travlang#1}}
\newcommand{\travlangcodefragment}[1]{{\ttfamily\setlength{\parindent}{0cm}%
\raggedright#1}}
\newcommand{\travlanginlinecode}[1]{{\ttfamily#1}}
\newenvironment{travlangarrow}{}{}
\newenvironment{travlangexception}{\bfseries}{}
\newenvironment{travlangextension}{\bfseries}{}
\newenvironment{travlangconstructor}{\bfseries}{}
\newenvironment{travlangtype-var}{\itshape\ttfamily}{}
\definecolor{lightgray}{gray}{0.97}
\definecolor{gray}{gray}{0.5}
\newenvironment{travlangindent}{\begin{adjustwidth}{2em}{0pt}}{\end{adjustwidth}}
\newenvironment{travlangtabular}[1]{\begin{tabular}{#1}}%
{\end{tabular}}
\newcommand{\bold}[1]{{\bfseries#1}}
\fi

\iftravlangdoc
\newcommand{\docitem}[2]{\input{#2}}
\else
\newcommand{\docitem}[2]{\input{#1/#2}}
\fi
\usepackage[english]{babel}
\usepackage[strings,nohyphen]{underscore}

\begin{document}
\chapter{Stdlib}
\docitem{libref}{Stdlib.tex}
\input{stdlib_input}
\docitem{libref}{travlang_operators.tex}
\chapter{Dynlink}
\docitem{libref}{Dynlink.tex}
\chapter{Str}
\docitem{libref}{Str.tex}
\chapter{Thread}
\docitem{libref}{Event.tex}
\docitem{libref}{Thread.tex}
\chapter{Unix}
\docitem{libref}{UnixLabels.tex}
\docitem{libref}{Unix.tex}
\chapter{Compilerlibs}
\docitem{compilerlibref}{Compiler_libs.tex}
\input{compilerlibs_input.tex}
\end{document}
